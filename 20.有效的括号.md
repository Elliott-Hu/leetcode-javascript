## 20.有效的括号

题干中有效的括号是成对嵌套的，因此在多层嵌套的情况下，需要一种数据结构来记录当前的开合状态。未匹配到对应右括号的左括号应该继续等待匹配。

这种情况是不是跟 js 执行上下文时很像呢？当父函数里有子函数时，父函数先入栈执行，子函数入栈执行，执行子函数完毕，子函数出栈，然后父函数执行完毕出栈。

我们可以把左括号当成是执行，入栈，碰到右括号当成是执行完毕的信号，将对应的左括号弹出栈。

唯一有一点不同的地方在于，假如我们提前拿到右括号，那么意味着括号是不成对的，这时候就可以直接判错了。

```js
var isValid = function(s) {
  const stack = [];
  // 一开始我是使用 indexOf 的方式来匹配的
  // 后面发现用 hash 更快一些
  const hash = {
    "(": ")",
    "[": "]",
    "{": "}"
  }

  // 实际上如果是优先判断匹配，代码可以更短
  // 就执行的效率来说取决于测试用例的错误用例多还是正确的用例多
  // 如果错误的用例多，则以下的解法更加高效
  for(let i = 0, len = s.length, a; i < len; i ++) {
    a = s[i]
    if (hash[a]) {
      stack.push(a)
      continue
    }

    if (!stack.length) {
      return false
    }

    if (a != hash[stack.slice(-1)]) {
      stack.push(a)
      continue
    }
    stack.pop()
  }


  return !stack.length
};
```
